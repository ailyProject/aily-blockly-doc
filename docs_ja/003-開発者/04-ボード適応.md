# ボード適応ガイド  

## 開発とデバッグ方法  

### 開発者モードを開く
`メニュー > 設定 > 開発者モード`を通じて、開発者モードを開きます。このとき、blocklyワークスペースの左下にある`ライブラリ管理`ボタンの右側に🔁アイコンが表示されます。このアイコンは、ライブラリソースコードを変更した後、手動でライブラリをリロードするために使用されます。

## 既存のボードに基づいて適応
ボードがArduino公式ボードと同じでavr、renesas、またはesp32を使用している場合、既存の設定で類似の設定ファイルを見つけ、コピーしてこれに基づいて変更できます。

### Arduino互換ボードの適応  
現在のバージョンはavrおよびrenesasコアのArduino互換ボードをサポートしています。arduino_uno、arduino_uno_r4ディレクトリを参照してください

### esp32適応
このリポジトリにはesp32、esp32c3、esp32s3の3つのテンプレートが用意されています。ボードのコアモデルを決定し、対応するフォルダをコピーしてボード名に変更し、package.json、board.jsonファイルを適宜変更します。
`/template`はプロジェクトの初期テンプレートプロジェクトです。ボードにいくつかのライブラリが付属している場合、`/template/package.json`に追加すると、ユーザーが新しいプロジェクトを作成した後、対応するライブラリが自動的にロードされます。

### STM32適応  
作成中  

### Raspberry Pi RPシリーズMCU適応  
作成中  

### カスタムコンパイルパラメータ適応
ボードのコンパイルパラメータはテンプレート`board.json`ファイルの`compilerParam`パラメータで設定されます。特別なコンパイル設定要件がある場合は、以下のような方法で設定できます（arduino-cliの使用方法と同じ）。
```
compile -b esp32:esp32:esp32c3 --build-property build.flash_mode=dio --build-property build.flash_freq=80m --build-property build.flash_size=4MB
```

### ライブラリのインストール
ライブラリテンプレートまたは自分で作成したライブラリを、コンピューターの任意の場所（例：`d:\arduino_test`）に配置できます。
次に、aily blocklyでプロジェクトを開き、ターミナルを開いて入力します：
```
npm i d:\arduino_test
```
これで、このプロジェクトにこのボードをインストールできます。

### ライブラリのリロード
`プロジェクト管理`の右側にある🔁アイコンをクリックすると、プロジェクトをリロードできます。

### ライブラリの変更
プロジェクトディレクトリの`node_modules\@aily-project\<ボード名>`を直接変更し、aily blocklyでリロードしてテストできます；
または`d:\arduino_test`の元のボードファイルを変更し、再度ライブラリをインストールしてテストすることもできます。

## ライブラリの提出 
まず、このプロジェクトを個人リポジトリにフォークできます。次に、新しく作成したボード設定をその中に配置し、Pull requestsを提出します。
Naihe colに連絡してマージするか、プロジェクトの他の管理者がマージするのを待ちます。  
マージが完了すると、npmリポジトリにプッシュされ、その後すべてのユーザーが開発したライブラリを使用できます。
