# 串口监视器使用说明

串口监视器是一个功能强大的串口通信调试工具，支持数据收发、实时图表显示、快捷发送等多种功能。

---

## 目录

- [基础设置](#基础设置)
  - [串口选择](#串口选择)
  - [波特率设置](#波特率设置)
  - [高级串口设置](#高级串口设置)
  - [连接/断开串口](#连接断开串口)
- [数据显示区](#数据显示区)
  - [显示模式设置](#显示模式设置)
  - [搜索功能](#搜索功能)
  - [数据导出](#数据导出)
  - [清空显示](#清空显示)
  - [折线图功能](#折线图功能)
- [数据发送区](#数据发送区)
  - [发送模式设置](#发送模式设置)
  - [快捷发送](#快捷发送)
  - [快捷发送编辑器](#快捷发送编辑器)
- [快捷键](#快捷键)
- [常见问题](#常见问题)

---

## 基础设置

### 串口选择

1. 点击 **串口** 下拉框
2. 从列表中选择目标串口设备
3. 如果设备已连接，将显示设备名称（如 `COM3`、`/dev/ttyUSB0` 等）
4. 系统会自动识别并高亮显示与当前开发板匹配的串口

> **提示**: 如果只检测到一个串口，系统将自动选择该串口。

### 波特率设置

1. 点击 **波特率** 下拉框
2. 选择合适的波特率

**支持的波特率**：

| 常用波特率 | 高速波特率 |
|-----------|-----------|
| 4800      | 460800    |
| 9600      | 921600    |
| 19200     | 1000000   |
| 38400     | 2000000   |
| 57600     | 3000000   |
| 115200    | 4000000   |
| 230400    |           |

> **注意**: 波特率必须与目标设备的设置一致，否则会出现乱码。

### 高级串口设置

点击设置栏右侧的 **齿轮图标** (⚙️) 展开高级设置面板：

| 参数 | 可选值 | 默认值 | 说明 |
|-----|--------|-------|------|
| **数据位** | 5, 6, 7, 8 | 8 | 每个字符的数据位数 |
| **停止位** | 1, 1.5, 2 | 1 | 停止位长度 |
| **校验位** | 无, 奇校验, 偶校验, 标记, 空格 | 无 | 错误检测方式 |
| **流控制** | 无, RTS/CTS, XON/XOFF | 无 | 数据流控制方式 |

> **提示**: 修改高级设置后，如果串口已连接，系统会自动重新连接以应用新设置。

### 连接/断开串口

- 使用设置栏右侧的 **开关按钮** 控制串口连接
- **开启**：连接到选定的串口
- **关闭**：断开串口连接

连接成功后，窗口标题会显示当前串口和波特率信息，例如：`串口监视器（COM3 - 115200）`

---

## 数据显示区

数据显示区位于界面中央，用于显示接收和发送的数据。

### 数据类型标识

| 标识 | 说明 |
|-----|------|
| **RX** | 接收到的数据 |
| **TX** | 发送的数据 |
| **SYS** | 系统消息（如连接状态、信号设置等） |

### 显示模式设置

数据显示区右侧提供以下显示控制按钮：

| 图标 | 功能 | 说明 |
|-----|------|------|
| **Hex** | 十六进制显示 | 将数据以十六进制格式显示（如 `FF A1 B2`） |
| ↵ | 自动换行 | 自动将长数据换行显示 |
| ↓ | 自动滚动 | 新数据到达时自动滚动到底部 |
| 🕐 | 显示时间戳 | 在每条数据前显示接收/发送时间 |
| 👁 | 显示控制字符 | 将控制字符显示为可见符号（如 `\r\n`、`\t` 等） |

### 搜索功能

1. 点击 **放大镜图标** (🔍) 打开搜索框
2. 输入要搜索的关键词
3. 匹配的内容会高亮显示
4. 使用 **上一个 / 下一个** 按钮在搜索结果间导航
5. 搜索框会显示当前匹配位置和总匹配数（如 `2/10`）

### 数据导出

1. 点击 **下载图标** (⬇️) 导出数据
2. 选择保存位置和文件名
3. 数据将以 `.txt` 格式保存
4. 导出内容会根据当前显示设置（时间戳、Hex模式、控制字符等）进行格式化

**默认文件名格式**：`log_YYYY_MM_DD_HH_mm_ss.txt`

### 清空显示

点击 **垃圾桶图标** (🗑️) 清空所有显示数据。

> **注意**: 清空后数据无法恢复，请在清空前导出重要数据。

### 折线图功能

串口监视器支持实时数据可视化：

1. 点击 **折线图图标** (📈) 打开图表面板
2. 图表会自动解析接收到的数值数据

**数据格式要求**：
```
value1,value2,value3,...\r\n
```

- 每行数据以换行符结束
- 多个数值用逗号分隔
- 每个数值会显示为独立的折线通道
- 支持最多10个通道，超出将循环使用颜色

**图表特性**：
- 自动缩放时间轴
- 实时滚动显示
- 最多保留1000个数据点
- 支持窗口大小调整

---

## 数据发送区

数据发送区位于界面底部，可通过拖拽顶部边缘调整高度。

### 发送模式设置

发送区右侧提供以下模式设置按钮：

| 图标 | 功能 | 说明 |
|-----|------|------|
| **Hex** | Hex发送模式 | 以十六进制格式发送数据（如输入 `FF A1` 将发送字节 `0xFF 0xA1`） |
| ↵ | 回车发送 | 开启后按 `Enter` 键直接发送，关闭后需要 `Ctrl+Enter` 发送 |
| **R** | 添加 CR | 发送时自动添加回车符 `\r` |
| **N** | 添加 LF | 发送时自动添加换行符 `\n` |

> **提示**: 同时开启 CR 和 LF 可在发送数据末尾添加 `\r\n`，这是最常用的行结束符。

### 发送数据

1. 在输入框中输入要发送的数据
2. 根据需要选择发送模式
3. 点击 **发送按钮** (✈️) 或使用快捷键发送

### 快捷发送

快捷发送栏位于发送区顶部，显示预设的快捷发送按钮：

**默认快捷发送项**：

| 名称 | 类型 | 功能 |
|-----|------|------|
| **DTR** | 信号 | 发送 DTR 控制信号 |
| **RTS** | 信号 | 发送 RTS 控制信号 |
| **发送文本** | 文本 | 发送预设的文本内容 |
| **发送Hex** | Hex | 发送预设的十六进制数据 |

点击快捷发送按钮即可立即发送对应内容。

### 快捷发送编辑器

1. 点击快捷发送栏右侧的 **编辑按钮** 打开编辑器
2. 使用 JSON 格式编辑快捷发送列表
3. 点击 **保存** 应用更改

**JSON 格式示例**：
```json
[
  { "name": "DTR", "type": "signal", "data": "DTR" },
  { "name": "RTS", "type": "signal", "data": "RTS" },
  { "name": "Hello", "type": "text", "data": "Hello World!" },
  { "name": "0xFF", "type": "hex", "data": "FF FF 00 01 02" }
]
```

**类型说明**：

| type | 说明 |
|------|------|
| `signal` | 控制信号（DTR 或 RTS） |
| `text` | 普通文本，会根据 CR/LF 设置添加行结束符 |
| `hex` | 十六进制数据，忽略 CR/LF 设置 |

---

## 快捷键

| 快捷键 | 功能 | 条件 |
|-------|------|------|
| `Enter` | 发送数据 | 开启"回车发送"模式 |
| `Ctrl + Enter` | 发送数据 | 关闭"回车发送"模式 |

---

## 常见问题

### Q: 串口列表为空或找不到设备？

**A**: 
- 检查设备是否正确连接
- 检查 USB 驱动是否已安装
- 尝试重新插拔设备
- 部分设备需要安装专用驱动（如 CH340、CP2102 等）

### Q: 接收到的数据显示乱码？

**A**: 
- 检查波特率设置是否与设备一致
- 检查数据位、停止位、校验位设置
- 尝试使用 Hex 模式查看原始数据

### Q: 无法发送数据？

**A**: 
- 确认串口已连接（开关已开启）
- 检查设备是否正常工作
- 检查流控制设置

### Q: 折线图不显示数据？

**A**: 
- 确认发送的数据格式正确（逗号分隔的数值，以换行符结束）
- 检查数据是否包含有效的数字
- 确保图表面板已打开

### Q: 配置丢失？

**A**: 
- 串口监视器会自动保存配置（串口、波特率、高级设置等）
- 配置保存在应用的配置文件中
- 重启应用后会自动恢复上次的设置

---

## 数据存储说明

串口监视器采用智能数据分组策略：

- 连续接收的数据会合并存储，减少条目数量
- 当接收间隔 **超过1秒** 时，创建新的数据条目
- 当单条数据持续时间 **超过10秒** 时，创建新的数据条目
- 发送数据或系统消息会立即创建独立条目

这种设计既保证了数据的完整性，又便于用户查看和分析通信记录。

---

## 版本信息

- 支持的操作系统：Windows、macOS、Linux
- 基于 Electron 和 Angular 构建
- 使用 SerialPort 库实现串口通信
