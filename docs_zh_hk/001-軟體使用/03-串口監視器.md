# 串口監視器使用說明

串口監視器是一個功能強大的串口通訊調試工具，支持資料收發、即時圖表顯示、快捷發送等多種功能。

---

## 目錄

- [基礎設定](#基礎設定)
  - [串口選擇](#串口選擇)
  - [波特率設定](#波特率設定)
  - [進階串口設定](#進階串口設定)
  - [連接/斷開串口](#連接斷開串口)
- [資料顯示區](#資料顯示區)
  - [顯示模式設定](#顯示模式設定)
  - [搜尋功能](#搜尋功能)
  - [資料匯出](#資料匯出)
  - [清空顯示](#清空顯示)
  - [折線圖功能](#折線圖功能)
- [資料發送區](#資料發送區)
  - [發送模式設定](#發送模式設定)
  - [快捷發送](#快捷發送)
  - [快捷發送編輯器](#快捷發送編輯器)
- [快捷鍵](#快捷鍵)
- [常見問題](#常見問題)

---

## 基礎設定

### 串口選擇

1. 點擊 **串口** 下拉選單
2. 從列表中選擇目標串口設備
3. 如果設備已連接，將顯示設備名稱（如 `COM3`、`/dev/ttyUSB0` 等）
4. 系統會自動識別並高亮顯示與當前開發板匹配的串口

> **提示**: 如果只檢測到一個串口，系統將自動選擇該串口。

### 波特率設定

1. 點擊 **波特率** 下拉選單
2. 選擇合適的波特率

**支持的波特率**：

| 常用波特率 | 高速波特率 |
|-----------|-----------|
| 4800      | 460800    |
| 9600      | 921600    |
| 19200     | 1000000   |
| 38400     | 2000000   |
| 57600     | 3000000   |
| 115200    | 4000000   |
| 230400    |           |

> **注意**: 波特率必須與目標設備的設定一致，否則會出現亂碼。

### 進階串口設定

點擊設定欄右側的 **齒輪圖示** (⚙️) 展開進階設定面板：

| 參數 | 可選值 | 預設值 | 說明 |
|-----|--------|-------|------|
| **資料位** | 5, 6, 7, 8 | 8 | 每個字元的資料位數 |
| **停止位** | 1, 1.5, 2 | 1 | 停止位長度 |
| **校驗位** | 無, 奇校驗, 偶校驗, 標記, 空格 | 無 | 錯誤檢測方式 |
| **流控制** | 無, RTS/CTS, XON/XOFF | 無 | 資料流控制方式 |

> **提示**: 修改進階設定後，如果串口已連接，系統會自動重新連接以應用新設定。

### 連接/斷開串口

- 使用設定欄右側的 **開關按鈕** 控制串口連接
- **開啟**：連接到選定的串口
- **關閉**：斷開串口連接

連接成功後，視窗標題會顯示當前串口和波特率資訊，例如：`串口監視器（COM3 - 115200）`

---

## 資料顯示區

資料顯示區位於介面中央，用於顯示接收和發送的資料。

### 資料類型標識

| 標識 | 說明 |
|-----|------|
| **RX** | 接收到的資料 |
| **TX** | 發送的資料 |
| **SYS** | 系統訊息（如連接狀態、信號設定等） |

### 顯示模式設定

資料顯示區右側提供以下顯示控制按鈕：

| 圖示 | 功能 | 說明 |
|-----|------|------|
| **Hex** | 十六進制顯示 | 將資料以十六進制格式顯示（如 `FF A1 B2`） |
| ↵ | 自動換行 | 自動將長資料換行顯示 |
| ↓ | 自動捲動 | 新資料到達時自動捲動到底部 |
| 🕐 | 顯示時間戳記 | 在每條資料前顯示接收/發送時間 |
| 👁 | 顯示控制字元 | 將控制字元顯示為可見符號（如 `\r\n`、`\t` 等） |

### 搜尋功能

1. 點擊 **放大鏡圖示** (🔍) 打開搜尋框
2. 輸入要搜尋的關鍵字
3. 匹配的內容會高亮顯示
4. 使用 **上一個 / 下一個** 按鈕在搜尋結果間導航
5. 搜尋框會顯示當前匹配位置和總匹配數（如 `2/10`）

### 資料匯出

1. 點擊 **下載圖示** (⬇️) 匯出資料
2. 選擇儲存位置和檔案名稱
3. 資料將以 `.txt` 格式儲存
4. 匯出內容會根據當前顯示設定（時間戳記、Hex模式、控制字元等）進行格式化

**預設檔案名稱格式**：`log_YYYY_MM_DD_HH_mm_ss.txt`

### 清空顯示

點擊 **垃圾桶圖示** (🗑️) 清空所有顯示資料。

> **注意**: 清空後資料無法恢復，請在清空前匯出重要資料。

### 折線圖功能

串口監視器支持即時資料視覺化：

1. 點擊 **折線圖圖示** (📈) 打開圖表面板
2. 圖表會自動解析接收到的數值資料

**資料格式要求**：
```
value1,value2,value3,...\r\n
```

- 每行資料以換行符結束
- 多個數值用逗號分隔
- 每個數值會顯示為獨立的折線通道
- 支持最多10個通道，超出將循環使用顏色

**圖表特性**：
- 自動縮放時間軸
- 即時捲動顯示
- 最多保留1000個資料點
- 支持視窗大小調整

---

## 資料發送區

資料發送區位於介面底部，可透過拖曳頂部邊緣調整高度。

### 發送模式設定

發送區右側提供以下模式設定按鈕：

| 圖示 | 功能 | 說明 |
|-----|------|------|
| **Hex** | Hex發送模式 | 以十六進制格式發送資料（如輸入 `FF A1` 將發送位元組 `0xFF 0xA1`） |
| ↵ | Enter發送 | 開啟後按 `Enter` 鍵直接發送，關閉後需要 `Ctrl+Enter` 發送 |
| **R** | 添加 CR | 發送時自動添加回車符 `\r` |
| **N** | 添加 LF | 發送時自動添加換行符 `\n` |

> **提示**: 同時開啟 CR 和 LF 可在發送資料末尾添加 `\r\n`，這是最常用的行結束符。

### 發送資料

1. 在輸入框中輸入要發送的資料
2. 根據需要選擇發送模式
3. 點擊 **發送按鈕** (✈️) 或使用快捷鍵發送

### 快捷發送

快捷發送欄位於發送區頂部，顯示預設的快捷發送按鈕：

**預設快捷發送項**：

| 名稱 | 類型 | 功能 |
|-----|------|------|
| **DTR** | 信號 | 發送 DTR 控制信號 |
| **RTS** | 信號 | 發送 RTS 控制信號 |
| **發送文字** | 文字 | 發送預設的文字內容 |
| **發送Hex** | Hex | 發送預設的十六進制資料 |

點擊快捷發送按鈕即可立即發送對應內容。

### 快捷發送編輯器

1. 點擊快捷發送欄右側的 **編輯按鈕** 打開編輯器
2. 使用 JSON 格式編輯快捷發送列表
3. 點擊 **儲存** 應用更改

**JSON 格式範例**：
```json
[
  { "name": "DTR", "type": "signal", "data": "DTR" },
  { "name": "RTS", "type": "signal", "data": "RTS" },
  { "name": "Hello", "type": "text", "data": "Hello World!" },
  { "name": "0xFF", "type": "hex", "data": "FF FF 00 01 02" }
]
```

**類型說明**：

| type | 說明 |
|------|------|
| `signal` | 控制信號（DTR 或 RTS） |
| `text` | 普通文字，會根據 CR/LF 設定添加行結束符 |
| `hex` | 十六進制資料，忽略 CR/LF 設定 |

---

## 快捷鍵

| 快捷鍵 | 功能 | 條件 |
|-------|------|------|
| `Enter` | 發送資料 | 開啟「Enter發送」模式 |
| `Ctrl + Enter` | 發送資料 | 關閉「Enter發送」模式 |

---

## 常見問題

### Q: 串口列表為空或找不到設備？

**A**: 
- 檢查設備是否正確連接
- 檢查 USB 驅動程式是否已安裝
- 嘗試重新插拔設備
- 部分設備需要安裝專用驅動程式（如 CH340、CP2102 等）

### Q: 接收到的資料顯示亂碼？

**A**: 
- 檢查波特率設定是否與設備一致
- 檢查資料位、停止位、校驗位設定
- 嘗試使用 Hex 模式查看原始資料

### Q: 無法發送資料？

**A**: 
- 確認串口已連接（開關已開啟）
- 檢查設備是否正常工作
- 檢查流控制設定

### Q: 折線圖不顯示資料？

**A**: 
- 確認發送的資料格式正確（逗號分隔的數值，以換行符結束）
- 檢查資料是否包含有效的數字
- 確保圖表面板已打開

### Q: 配置遺失？

**A**: 
- 串口監視器會自動儲存配置（串口、波特率、進階設定等）
- 配置儲存在應用程式的配置檔案中
- 重新啟動應用程式後會自動恢復上次的設定

---

## 資料儲存說明

串口監視器採用智慧資料分組策略：

- 連續接收的資料會合併儲存，減少條目數量
- 當接收間隔 **超過1秒** 時，創建新的資料條目
- 當單條資料持續時間 **超過10秒** 時，創建新的資料條目
- 發送資料或系統訊息會立即創建獨立條目

這種設計既保證了資料的完整性，又便於用戶查看和分析通訊記錄。

---

## 版本資訊

- 支持的作業系統：Windows、macOS、Linux
- 基於 Electron 和 Angular 建構
- 使用 SerialPort 函式庫實現串口通訊
